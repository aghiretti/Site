[
  {
    "path": "posts/11-01-2020-Co2StateSpace/",
    "title": "A dynamic factor analysis of the CO2 per capita emissions",
    "description": "In this post we will use dynamic factor analysis to investigate the per capita \nCO2 emissions produced over the last 100 years by 15 countries of different geographical and economical areas. To estimate the model we will use the R package MARSS.",
    "author": [
      {
        "name": "Alessandro Ghiretti",
        "url": {}
      }
    ],
    "date": "2021-02-14",
    "categories": [
      "R",
      "Econometrics",
      "Time series",
      "Environment"
    ],
    "contents": "\r\n\r\nContents\r\nIntroduction\r\nAnalysis\r\nData Description\r\nExploratory Data Analysis\r\nCO2 worldwide share\r\nCO2 per capita\r\n\r\nModel specification and estimation\r\nEstimated trends\r\nForecasts\r\nDiagnostics\r\n\r\nConclusions\r\n\r\n\r\n\r\nbody {\r\ntext-align: justify}\r\nIntroduction\r\nCarbon dioxide emissions are the primary driver of global climate change and it is widely recognized that to avoid the worst impacts of climate change, the world needs to urgently reduce emissions. Prior to the Industrial Revolution, emissions were very low and growth in emissions was still relatively slow until the mid-20th century. For example, in 1950 the world emitted just over 5 billion tonnes of (CO2), about the same as the US, or half of China’s annual emissions today. By 1990 this had quadrupled to 22 billion tonnes. Emissions have continued to grow rapidly and we now emit over 36 billion tonnes each year. Emissions growth has slowed over the last few years, but they have yet to reach their peak.\r\nThe purpose of this post is to use dynamic factor analysis to identify hidden common trends in the CO2 per capita emissions between the three main geographical areas of EU, North America and Asia. We will restrict our analysis to 15 of the main Global Economies and use the R package MARSS to fit the model.\r\nAnalysis\r\nData Description\r\nThe data that we consider is freely available at the following link:\r\nhttps://raw.githubusercontent.com/owid/co2-data/master/owid-co2-data.csv\r\nThe dataset contains annual data of several variables related to the CO2 emission of the different countries in the world, collected starting from 1900 through 2018. In our analysis we will restrict our attention to the period from 1900 to 2018 for the following countries: Italy, United Kingdom, France, Germany, Spain, United States, Canada, Japan, India, China, Argentina, Brazil, Peru, New Zealand and Australia.\r\n\r\n\r\n\r\nExploratory Data Analysis\r\nWe start the analysis by loading the data into R. In my case the data in in the project folder\r\n\r\n\r\n# Read data\r\nco2 <- read.csv(\"owid-co2-data.csv\")\r\n\r\n\r\n\r\nWe proceed by filtering out the countries that are not of interest and in addition, as it might be useful to compare the results at continent level, we add the variable zone which contains the continent of all the countries considered in the analysis.\r\n\r\n\r\n# Filter countries to include in the analysis\r\ncountries <- c(\"Italy\",\"United Kingdom\",\"France\",\"Germany\",\"Spain\",\"United States\", \r\n               \"Canada\",\"Japan\", \"India\", \"China\",  \"Argentina\",\r\n               \"Brazil\", \"Peru\", \"New Zealand\", \"Australia\")\r\n\r\n# Define geographical zones \r\nzone <- c(rep(\"Europe\",5), rep(\"North America\", 2), rep(\"Asia\",2),\r\n          rep(\"South America\",3), rep(\"Oceania\",2))\r\n\r\n# Add geographical zones to the data\r\nco2 <-co2 %>% \r\n  mutate(zone = ifelse(country %in% \r\n    c(\"Italy\",\"United Kingdom\",\"France\",\"Germany\",\"Spain\"),\r\n    \"Europe\",ifelse( country %in% c (\"United States\",\"Canada\"), \"North America\",\r\n    ifelse(country %in% c(\"Japan\", \"India\", \"China\"), \"Asia\",\r\n    ifelse(country %in% c(\"Argentina\",\"Brazil\", \"Peru\"),\"South America\", \"Oceania\")))))\r\n\r\n# Filter the data \r\ndat <- co2 %>% \r\n  # filter the countries and the year\r\n  filter(country %in% countries &\r\n         year >= 1910)\r\n\r\n\r\n\r\nNow we are ready to analyze our data.\r\nCO2 worldwide share\r\nIn order to gain insight about the CO2 emissions at a macro level, we start by looking at evolution of the CO2 worldwide share.\r\n\r\n\r\npreserved129b11356047fb1\r\n\r\nFigure 1: CO2 worldwide share\r\n\r\n\r\n\r\nFigure 1 shows immediately that for almost the entire period under study USA is the country with the highest global share of CO2 emissions. As can be seen from the graph, starting from 1970 the emerging countries started to increase their contribution to the global CO2 emissions. First China, which in 2006 surpassed the CO2 share of USA, and subsequently India, that in 2007 started to increase its share with a marked upward trend. Apart from these two emerging countries a downward trend in the CO2 share is observed for the majority of the countries under study. The trend is particularly evident for UK and Germany, which at at the beginning of the period were respectively the second and third country in terms of CO2 share. On the one hand the decrease in the share of CO2 might represent the will of the more developed countries to reduce or limit their CO2 emissions. As pollution became a really important topic especially in the last decade, the effort spent by the most developed countries to reduce CO2 emissions resulted in lower CO2 shares. On the other hand, the industrialization of the emerging countries such as China and India, which have increased their CO2 emissions resulted in a redistribution of the CO2 shares. Following further the analysis and considering the log transformed data in Figure 2, it is evident that in 1945, the end of the second world conflict, the CO2 share of several countries dropped consistently. In particular those of Germany and Italy being are the most evident.\r\n\r\n\r\npreserveb2a8da74f5ea0a6f\r\n\r\nFigure 2: log transform of the global CO2 share\r\n\r\n\r\n\r\nCO2 per capita\r\nHaving briefly inspected the CO2 at a global level, we now turn our attention to the CO2 per capita which represents the main variable of interest. Conversely from the CO2 share which represent the incidence of the CO2 emissions of one country at global level, the CO2 per capita can be considered as a proxy of the footprint, in terms of CO2, left by each citizen in the country. As before we start looking at the temporal structure of the CO2 per capita. The time series plot in Figure 3 reveals a surprising picture. While countries such as Australia and Canada account for as very small share of the Global CO2 emissions, the footprint left by every citizen appear to be particularly high. Therefore, despite the impact of these countries at a global level is low, compared to that of USA or China, the CO2 produced by each citizen is much higher. In particular,it is possible to see that, starting from 1975, three different patterns in the CO2 per capita series tarted to delineate. The first composed by USA, Canada and Australia which are the countries with the highest CO2 per capita. The second composed by Brazil, Peru and India. Poor countries with low CO2 per capita values. The third, the biggest, one composed by all the remaining countries. It is interesting to note that while for the developed countries during the last decade the CO2 per capita series exhibits a downward trend the same does not hold for Brazil, Peru and India for which the trend is slight increasing.\r\n\r\n\r\npreserve1c278ce6d1c44d65\r\n\r\nFigure 3: Time serie plot of the CO2 per capita emissions\r\n\r\n\r\n\r\n\r\n\r\n\r\nThe situation appears even clearer when we consider boxplots and time series aggregated at continent level. It is straigthforward to note that North America, Oceania and Europe are the zone with the highest CO2 per capita emissions. In Europe United Kingdom and Germany represent the two countries with the highest values on average.\r\n\r\npreserve64878d69d53b434e\r\n\r\nTo conclude our exploratory analysis we compute and examine the correlation of the CO2 per capita emissions between the different countries. It appears that in general there is high positive correlation between the CO2 levels observed in the different countries and apparently this correlation is not strictly related to the geographical area.\r\n\r\n\r\n\r\nModel specification and estimation\r\nHaving explored our data it is now time to specify and fit our model. In this case we will use a dynamic factor model to identify common trends between the CO2 per capita emissions of the different countries. Compared to VAR, dynamic factor models require less parameters to be estimated, and therefore they result particularly useful when the number of series considered is high. The genera idea behind a dynamic factor model is that the behavior of \\(k\\) time series can be described by a set of \\(m\\) common states where in general \\(m\\) is much smaller than \\(k\\). After the \\(m\\) states are obtained they can be used for different purposes, for example to identify common structures in the series, such as trends, cyclical or seasonal patterns or as proxy variables that resumes global structures of the underlying series. To define the model we will follow the notation proposed in Holmes et al. (2020) that is\r\n\\[\\begin{aligned}\r\nx_{t} & =B_{t} x_{t-1}+ u_{t}+ C_{t} c_{t}+ G_{t} w_{t}, & \\quad w_{t} \\sim MVN\\left(0, Q_{t}\\right) \\\\\r\ny_{t} & =Z_{t} x_{t}+a_{t}+D_{t} d_{t}+H_{t} v_{t}, & \\quad v_{t} \\sim MVN\\left(0, R_{t}\\right) \\\\\r\n\\end{aligned}\\]\r\nwhere \\(x_{1} \\sim MVN(\\pi, \\Lambda)\\) or \\(x_{0} \\sim MVN(\\pi, \\Lambda)\\). Thus, the resulting dynamic factor model (Durbin and Koopman (2012) and Holmes et al. (2020)) with the constraint necessary for identification is\r\n\\[\\begin{aligned}\r\n\r\n\r\n\\underbrace{\\begin{pmatrix}\r\nx_{1} \\\\\r\nx_{2} \\\\\r\n\\vdots \\\\\r\nx_{m}\r\n\\end{pmatrix}_{t}}_{x_{t}}\r\n\r\n&= \r\n\r\n\\underbrace{\\begin{pmatrix}\r\n1 & 0 & \\cdots & 0 \\\\\r\n0 & 1 & \\cdots & 0 \\\\\r\n\\vdots& \\vdots & \\ddots & \\vdots \\\\\r\n0 & 0 & \\cdots & 1\r\n\\end{pmatrix}}_{B}\r\n\r\n\\underbrace{\\begin{pmatrix}\r\nx_{1} \\\\\r\nx_{2} \\\\\r\n\\vdots \\\\\r\nx_{m}\r\n\\end{pmatrix}_{t-1}}_{x_{t-1}}\r\n\r\n+\r\n\r\n\\underbrace{\\begin{pmatrix}\r\nv_{1} \\\\\r\nv_{2} \\\\\r\n\\vdots \\\\\r\nv_{m+k}\r\n\\end{pmatrix}_{t}}_{v_{t}} \\\\\r\n\r\n\r\n\r\n\\underbrace{\\begin{pmatrix}\r\ny_{1} \\\\\r\ny_{2} \\\\\r\n\\vdots \\\\\r\ny_{m+k}\r\n\\end{pmatrix}_{t}}_{y_{t}}\r\n\r\n&= \r\n\r\n\\underbrace{\\begin{pmatrix}\r\nz_{11} & 0 & \\cdots & 0 \\\\\r\nz_{21} & z_{22} & \\cdots & 0 \\\\\r\n\\vdots& \\vdots & \\ddots & \\vdots \\\\\r\nz_{k1} & z_{k2} & \\cdots & z_{km}\r\n\\end{pmatrix}}_{Z}\r\n\r\n\\underbrace{\\begin{pmatrix}\r\nx_{1} \\\\\r\nx_{2} \\\\\r\n\\vdots \\\\\r\nx_{m}\r\n\\end{pmatrix}_{t}}_{x_{t}}\r\n\r\n+\r\n\r\n\\underbrace{\\begin{pmatrix}\r\nw_{1} \\\\\r\nw_{2} \\\\\r\n\\vdots \\\\\r\nw_{m}\r\n\\end{pmatrix}_{t}}_{w_{t}} \\\\\r\n\r\n\r\n\r\n\\end{aligned}\\]\r\nwhere \\(v_{t} \\sim N(0, V)\\) and \\(w \\sim N(0,Q)\\). According to our model the \\(k\\) CO2 per capita emissions are related to \\(m\\) common hidden trends, each one described by a random walk and possibly correlated to the others. The relevance that each state has on the observed series is expressed by the corresponding factor loading \\(z_{jq}\\). Despite the number of states as well as the structure of the covariance matrix should be identified from the data, since these are computationally intensive activities we will directly proceed to fit a model with three hidden states and an unrestricted covariance matrix. As it is generally suggested when fitting this kind of models the observations are standardized. In the following we reshape our data in a \\(N \\times T\\) matrix and proceed to fit the model.\r\n\r\n\r\n# row: country column: year\r\ny <- dat %>% \r\n  select(co2_per_capita, year, country, iso_code) %>% \r\n  pivot_wider(names_from = year, values_from = co2_per_capita) %>% \r\n  arrange(iso_code)\r\n\r\n# convert the data in matrix\r\ny = as.matrix(y[,3:ncol(y)])\r\n\r\n# set parameters for optimizer\r\ncntl.list <- list(minit = 200, maxit = 5000, allow.degen = FALSE)\r\n\r\n#  Define values for grid search\r\n# define covariance structures for the states\r\nR.structure <- \"unconstrained\"\r\nm <- 3\r\n\r\nmodel.list <- list(m = m, R = R.structure)\r\n# fit model to standardized data\r\nmod.me <- MARSS(y, model = model.list, z.score = TRUE, form = \"dfa\",\r\n                control = cntl.list, silent = TRUE)\r\n\r\n\r\n\r\nEstimated trends\r\nOnce we have estimated our model we can extract and plot the states of the system. Before to plot the estimated states and the factor loadings it is important to specify that the estimates obtained with our model are not unique and depending on the model specification different results can be observed. It is common practice therefore, re express the results with a standard transformation whose aim in general is to highlight some characteristics of the underlying series. Following Holmes et al. (2020) we adopt the varimax rotation. The aim of the varimax rotation is to maximize the sum of the variance of the squared loadings. This usually results in high factor loadings for a smaller number of variables and low factor loadings for the rest.\r\n\r\n\r\n# perform rotation of the states before plotting\r\n# get the inverse of the rotation matrix\r\nZ.est <- coef(mod.me, type = \"matrix\")$Z\r\nH.inv <- 1\r\nif (ncol(Z.est) > 1){\r\nH.inv <- varimax(coef(mod.me, type = \"matrix\")$Z)$rotmat}\r\n\r\n# rotate factor loadings\r\nZ.rot <- Z.est %*% H.inv\r\n#extract the rotated loadings and reshape into a matrix\r\nloadings <- t(Z.rot) %>% data.frame()\r\ncolnames(loadings) <- unique(dat$country)\r\nloadings$x <- c(\"X1\",\"X2\", \"X3\")\r\n# add zone to the loadings\r\nloadings <- loadings %>% \r\n  pivot_longer(-c(\"x\"), names_to = \"country\", values_to = \"loading\") %>% \r\n  mutate(zone = ifelse(country %in% \r\n    c(\"Italy\",\"United Kingdom\",\"France\",\"Germany\",\"Spain\"),\r\n    \"Europe\",ifelse( country %in% c (\"United States\",\"Canada\"), \"North America\",\r\n    ifelse(country %in% c(\"Japan\", \"India\", \"China\"), \"Asia\",\r\n    ifelse(country %in% c(\"Argentina\",\"Brazil\", \"Peru\"),\"South America\", \"Oceania\")))))\r\n\r\n\r\n# rotate trends and covnert them to a data frame\r\ntrends.rot <- solve(H.inv) %*% mod.me$states\r\ntrends.rot <- t(trends.rot)\r\ntrends.rot <- data.frame(trends.rot)\r\n\r\n# assign column names\r\ncolnames(trends.rot) <- c(\"X1\",\"X2\",\"X3\")\r\n\r\n# add year and reshape\r\ntrends.rot$Year <- seq(from = 1910, to = 2018)\r\ntrends.rot <- trends.rot %>% \r\n  pivot_longer(cols = -c(\"Year\"),\r\n              names_to = \"state\", values_to = \"val\") %>% \r\n  group_by(state) %>% dplyr::arrange(Year, .by_group = TRUE)\r\n\r\n# obtain estimated states\r\ns <- tsSmooth(mod.me)\r\ncolnames(s) <- c(\"state\", \"Year\", \"val\",\"se\")\r\ns$statesRot <- trends.rot$state\r\ns$Year <- rep(seq(from = 1910, to =2018),3)\r\n\r\n\r\n\r\n\r\n\r\n\r\nFigure 4: Estimate smoothed states\r\n\r\n\r\n\r\n\r\n\r\npreserve8613c093a312cf6e\r\n\r\nFigure 5: Estimated factor loadings\r\n\r\n\r\n\r\nFigure 4 shows the smoothed states before and after the varimax rotation and Figure 5 the rotated factors loadings of the different series. by looking at 4 state X1 represent the increasing trend observed for almost the entire period. By looking at the loadings in Figure 5 we immediately see that all the loadings associated to X1 are positive and their values apart from Italy, United Kingdom and China are particularly high. All the loadings associated to X2 are negative and the highest values are observed for India, France and United Kingdom. In this case negative fluctuations in X3 are reflected in increasing movements in the observed series. Finally the X3 state is characterized by a downward trend starting from 1975. The highest loadings in absolute value are observed for Italy, China, and Japan. Conversely from the other where all the loadings associated to them had the same sign here different countries have different loadings of different sign.\r\nForecasts\r\nHaving inspected the common trends it is time to check if the model is truly able to produce accurate forecasts for the series considered. We consider the one step ahead predictions.\r\n\r\n\r\n\r\n\r\n\r\np1 <- y.hat %>% ggplot() +\r\n  geom_point(aes(x = Year, y = y, group = country),color = \"pink\", alpha = 0.7) +\r\n  geom_line(aes(x = Year, y = estimate, group = country), \r\n            size = 1, color = \"royalblue\", alpha = 0.7) +\r\n  facet_wrap(~country, ncol = 3) +\r\n  ggtitle(\"One step ahead predictions\") +\r\n  theme_minimal()\r\n\r\nggplotly(p1)\r\n\r\n\r\n\r\npreserveb200720cff555a11\r\n\r\nFigure 6: One step ahead predictions\r\n\r\n\r\n\r\nFrom Figure 6 it appears that for the majority of the countries the forecasts produced by the model are not that bad. Unfortunately the model seems not able to capture the abrupt changes observed in the United States and United Kingdom series during 1930. Moreover, few downward spikes are evident in the CO2 per capita series of France and Italy which deteriorate remarkedly the predictive performances of the model for these countries. In order to quantify the accuracy and compare numerically the predictive power of the model for the different countries we compute the following error metrics:\r\nMSE: \\(mean((y - \\hat{y})^{2})\\)\r\nMAE: \\(mean(|y - \\hat{y}|)\\)\r\nMAPE:\\(mean \\left( \\left| \\frac{100( y - \\hat{y})}{y} \\right| \\right)\\)\r\n\r\n\r\n# define the metrics\r\nmse <- function(x){\r\n   m <- mean((x$y - x$estimate)^2)\r\n   return(m)\r\n}\r\n\r\nmae <- function(x){\r\n   m <- mean(abs(x$y - x$estimate))\r\n   return(m)\r\n}\r\n\r\nmape <- function(x){\r\n   m <- mean(abs(((100*(x$y - x$estimate))/x$y)))\r\n   return(m)\r\n}\r\n\r\n# estimate the metrics for the different series\r\nmetrics <- y.hat %>% group_by(country) %>% \r\n  nest() %>% mutate(mse = lapply(data,mse),\r\n                    mae = lapply(data,mae),\r\n                    mape = lapply(data,mape)) %>% \r\nunnest() %>% \r\n  dplyr::select(country,mse,mae,mape) %>% \r\n  arrange(desc(mse), desc(mae), desc(mape)) %>% \r\n  unique()\r\n\r\nmetrics %>% formattable(list(`mae` = color_bar(\"#FA614B\"),\r\n                             `mse` = color_bar(\"#FA614B\"),\r\n                             `mape` = color_bar(\"#FA614B\")))\r\n\r\n\r\n\r\ncountry\r\n\r\n\r\nmse\r\n\r\n\r\nmae\r\n\r\n\r\nmape\r\n\r\n\r\nItaly\r\n\r\n\r\n0.56508402\r\n\r\n\r\n0.57739290\r\n\r\n\r\n186.56576\r\n\r\n\r\nUnited Kingdom\r\n\r\n\r\n0.33120877\r\n\r\n\r\n0.42592765\r\n\r\n\r\n279.83412\r\n\r\n\r\nFrance\r\n\r\n\r\n0.23642793\r\n\r\n\r\n0.37216282\r\n\r\n\r\n92.63379\r\n\r\n\r\nUnited States\r\n\r\n\r\n0.20303764\r\n\r\n\r\n0.33241904\r\n\r\n\r\n111.33620\r\n\r\n\r\nIndia\r\n\r\n\r\n0.14264339\r\n\r\n\r\n0.29787671\r\n\r\n\r\n159.83815\r\n\r\n\r\nCanada\r\n\r\n\r\n0.09398519\r\n\r\n\r\n0.21591708\r\n\r\n\r\n28.95066\r\n\r\n\r\nJapan\r\n\r\n\r\n0.05360373\r\n\r\n\r\n0.18523679\r\n\r\n\r\n104.82515\r\n\r\n\r\nChina\r\n\r\n\r\n0.04526960\r\n\r\n\r\n0.17386567\r\n\r\n\r\n44.40705\r\n\r\n\r\nSpain\r\n\r\n\r\n0.04395102\r\n\r\n\r\n0.17009672\r\n\r\n\r\n64.30130\r\n\r\n\r\nPeru\r\n\r\n\r\n0.03606612\r\n\r\n\r\n0.13994847\r\n\r\n\r\n17.61438\r\n\r\n\r\nGermany\r\n\r\n\r\n0.02837211\r\n\r\n\r\n0.12229581\r\n\r\n\r\n16.90300\r\n\r\n\r\nBrazil\r\n\r\n\r\n0.02674690\r\n\r\n\r\n0.10878274\r\n\r\n\r\n16.76209\r\n\r\n\r\nArgentina\r\n\r\n\r\n0.02661388\r\n\r\n\r\n0.11943071\r\n\r\n\r\n39.87676\r\n\r\n\r\nAustralia\r\n\r\n\r\n0.02160730\r\n\r\n\r\n0.08686050\r\n\r\n\r\n25.14937\r\n\r\n\r\nNew Zealand\r\n\r\n\r\n0.01860601\r\n\r\n\r\n0.08320709\r\n\r\n\r\n13.43328\r\n\r\n\r\nThere is a general agreement in the MSE and MAE metrics that confirm the situation observed by the one step ahead predictions plot. Italy, United Kingdom, United States, France, India and Canada are the countries for which the model produces the worst forecasts, nevertheless, a slightly different picture is observed when we look at the MAPE. According to MAPE United Kingdom appear the country with the worst one step ahead predictions errors and the predictions for Japan, China and Spain worsen compared to those observed with the MAE and MSE.\r\nDiagnostics\r\nWe conclude the analysis with the inspection of the residuals plot, to check if the underlying model assumptions of normality are satisfied.\r\n\r\n\r\n\r\n\r\n\r\n# plot model residuals\r\np1 <- mod.res %>% ggplot() +\r\n  geom_point(aes(x = Year, y = .resids, group = country), color = \"royalblue\", alpha = 0.4) +\r\n  geom_ribbon(aes(x = Year, ymin = - 1.96*.sigma, \r\n                  ymax = +1.96*.sigma), alpha = 0.4) +\r\n  facet_wrap(~country, ncol = 3, scales = \"free\") +\r\n  theme_minimal() +\r\n  ylab(\"residuals\") + ggtitle(\"Fitted residuals\")\r\n\r\nggplotly(p1)\r\n\r\n\r\n\r\npreserve958cb0f25fd911b0\r\n\r\nFigure 7: Fitted residuals plot\r\n\r\n\r\n\r\n\r\n\r\npreservea386136d3de1b0f4\r\n\r\nFigure 8: State residuals plot\r\n\r\n\r\n\r\nFrom Figure 7 it is immediate to note that the residuals are not well dispersed and cyclical behavior is observed in almost all the series. The residuals analysis highlight also the presence of several outlying units for many series. Coming to the state residuals, which are reported in Figure 8, they appear, with the exception of state X1,well dispersed with no evident structure. Few potential outliers are observed for state X3, however, their values are not particularly large. We next move the inspection of the QQ-plot of the fitted and of the state residuals.\r\n\r\npreservecc9d7a5d2688822c\r\n\r\n\r\npreserve060c3c2866cd9fb0\r\n\r\nOverall the normality assumption appears satisfied both for the fitted residuals as well as for the state residuals. Slight deviations in the fitted residuals are observed for Italy, United Kingdom and USA while in the state residuals heavier tails are observed in state X2.\r\nConclusions\r\nIn this post we have investigated the application of dynamic factor model to model the CO2 per capita emissions of 15 countries. Despite the model produced good forecasts for some countries it resulted unsatisfactory for others. In order to improve the analysis explanatory variables such as GDP and population growth could be included in the model. Moreover outliers point could be removed or even better accounted in the analysis with the use of dummy variables. Overall the normality assumption appeared satisfied but a different dynamic in the factors, or the inclusion of lagged variables should be adopted to account for the cyclical pattern observed in the residuals. In addition it would be interesting to replicate the analysis by estimating the correlation structure as well as the number of hidden states\r\n\r\n\r\n\r\nDurbin, James, and Siem Jan Koopman. 2012. Time Series Analysis by State Space Methods. Oxford university press.\r\n\r\n\r\nHarvey, A. C., and G. D. A. Phillips. 1982. “The Estimation of Regression Models with Time-Varying Parameters.” In Games, Economic Dynamics, and Time Series Analysis, edited by M. Deistler, E. Fürst, and G. Schwödiauer, 306–21. Heidelberg: Physica-Verlag HD.\r\n\r\n\r\nHarvey, Andrew C, and Clara Fernandes. 1989. “Time Series Models for Count or Qualitative Observations.” Journal of Business & Economic Statistics 7 (4): 407–17.\r\n\r\n\r\nHolmes, Elizabeth, Eric Ward, Mark Scheuerell, and Kellie Wills. 2020. MARSS: Multivariate Autoregressive State-Space Modeling. https://CRAN.R-project.org/package=MARSS.\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/11-01-2020-Co2StateSpace/Preview.jpg",
    "last_modified": "2021-02-14T17:35:03+01:00",
    "input_file": "11-01-2020-Co2StateSpace.utf8.md"
  }
]
