"0","x <-  adv.ts[,2:13]"
"0","y <-  adv.ts[,14] "
"0",""
"0","# Define the linear regression model"
"0","# Logarithmic transformation is applied to variance components to increase"
"0","# the stability of the Kalman Filter"
"0","buildTVREG <-  function(parm, x.mat){"
"0","  # parametrize the model as log(variance)"
"0","  parm <- exp(parm)"
"0","  # return function output"
"0","  return(dlmModReg(X = x.mat, dV = parm[1], dW = parm[2:14]))"
"0","}"
"0",""
"0","# Set initial values for optimizer"
"0","start.values = rep(0,14)"
"0",""
"0","# Obtain maximum likelihood estimates"
"0","TVREG.mle = dlmMLE(y = y, parm = start.values, x.mat = x, buildTVREG)"
