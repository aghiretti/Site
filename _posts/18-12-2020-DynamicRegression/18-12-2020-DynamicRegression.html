<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Media Mix Modeling via Dynamic Linear Regression</title>

  <meta property="description" itemprop="description" content="In this post we discuss the application of the Dynamic Linear Regression &#10;model to Media Mix Modeling. To fit the model we will use the R package MARSS."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2020-08-12"/>
  <meta property="article:created" itemprop="dateCreated" content="2020-08-12"/>
  <meta name="article:author" content="Alessandro Ghiretti"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Media Mix Modeling via Dynamic Linear Regression"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="In this post we discuss the application of the Dynamic Linear Regression &#10;model to Media Mix Modeling. To fit the model we will use the R package MARSS."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Media Mix Modeling via Dynamic Linear Regression"/>
  <meta property="twitter:description" content="In this post we discuss the application of the Dynamic Linear Regression &#10;model to Media Mix Modeling. To fit the model we will use the R package MARSS."/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Time series analysis by state space methods;citation_publication_date=2012;citation_publisher=Oxford university press;citation_author=James Durbin;citation_author=Siem Jan Koopman"/>
  <meta name="citation_reference" content="citation_title=Time series models for count or qualitative observations;citation_publication_date=1989;citation_publisher=Taylor &amp; Francis;citation_volume=7;citation_author=Andrew C Harvey;citation_author=Clara Fernandes"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","preview","author","date","output","bibliography","nocite"]}},"value":[{"type":"character","attributes":{},"value":["Media Mix Modeling via Dynamic Linear Regression"]},{"type":"character","attributes":{},"value":["In this post we discuss the application of the Dynamic Linear Regression \nmodel to Media Mix Modeling. To fit the model we will use the R package MARSS.\n"]},{"type":"character","attributes":{},"value":["Econometrics","R","Time Series","Marketing"]},{"type":"character","attributes":{},"value":["Preview.jpg"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Alessandro Ghiretti"]},{"type":"NULL"}]}]},{"type":"character","attributes":{},"value":["08-12-2020"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]}]}]},{"type":"character","attributes":{},"value":["references.bib"]},{"type":"character","attributes":{},"value":["@durbin2012time, @harvey1989time, @dlmharvey, @MARSS, @chan2017challenges, "]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["18-12-2020-DynamicRegression_files/anchor-4.2.2/anchor.min.js","18-12-2020-DynamicRegression_files/bowser-1.9.3/bowser.min.js","18-12-2020-DynamicRegression_files/crosstalk-1.1.0.1/css/crosstalk.css","18-12-2020-DynamicRegression_files/crosstalk-1.1.0.1/js/crosstalk.js","18-12-2020-DynamicRegression_files/crosstalk-1.1.0.1/js/crosstalk.js.map","18-12-2020-DynamicRegression_files/crosstalk-1.1.0.1/js/crosstalk.min.js","18-12-2020-DynamicRegression_files/crosstalk-1.1.0.1/js/crosstalk.min.js.map","18-12-2020-DynamicRegression_files/distill-2.2.21/template.v2.js","18-12-2020-DynamicRegression_files/figure-html5/fittedres-1.png","18-12-2020-DynamicRegression_files/figure-html5/plot-elasticities-1.png","18-12-2020-DynamicRegression_files/figure-html5/smoothstate-1.png","18-12-2020-DynamicRegression_files/figure-html5/state-plot-1.png","18-12-2020-DynamicRegression_files/figure-html5/stateres-1.png","18-12-2020-DynamicRegression_files/figure-html5/unnamed-chunk-10-1.png","18-12-2020-DynamicRegression_files/figure-html5/unnamed-chunk-11-1.png","18-12-2020-DynamicRegression_files/figure-html5/unnamed-chunk-2-1.png","18-12-2020-DynamicRegression_files/figure-html5/unnamed-chunk-3-1.png","18-12-2020-DynamicRegression_files/figure-html5/unnamed-chunk-4-1.png","18-12-2020-DynamicRegression_files/figure-html5/unnamed-chunk-7-1.png","18-12-2020-DynamicRegression_files/figure-html5/unnamed-chunk-8-1.png","18-12-2020-DynamicRegression_files/header-attrs-2.6/header-attrs.js","18-12-2020-DynamicRegression_files/htmlwidgets-1.5.3/htmlwidgets.js","18-12-2020-DynamicRegression_files/jquery-1.11.3/jquery.min.js","18-12-2020-DynamicRegression_files/kePrint-0.0.1/kePrint.js","18-12-2020-DynamicRegression_files/lightable-0.0.1/lightable.css","18-12-2020-DynamicRegression_files/plotly-binding-4.9.2.2/plotly.js","18-12-2020-DynamicRegression_files/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css","18-12-2020-DynamicRegression_files/plotly-main-1.52.2/plotly-latest.min.js","18-12-2020-DynamicRegression_files/typedarray-0.1/typedarray.min.js","18-12-2020-DynamicRegression_files/webcomponents-2.0.0/webcomponents.js","Preview.jpg","references.bib"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="18-12-2020-DynamicRegression_files/header-attrs-2.6/header-attrs.js"></script>
  <script src="18-12-2020-DynamicRegression_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="18-12-2020-DynamicRegression_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="18-12-2020-DynamicRegression_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="18-12-2020-DynamicRegression_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="18-12-2020-DynamicRegression_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Media Mix Modeling via Dynamic Linear Regression","description":"In this post we discuss the application of the Dynamic Linear Regression \nmodel to Media Mix Modeling. To fit the model we will use the R package MARSS.","authors":[{"author":"Alessandro Ghiretti","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2020-08-12T00:00:00.000+02:00","citationText":"Ghiretti, 2020"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Media Mix Modeling via Dynamic Linear Regression</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">Econometrics</div>
<div class="dt=tag">R</div>
<div class="dt=tag">Time Series</div>
<div class="dt=tag">Marketing</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>In this post we discuss the application of the Dynamic Linear Regression model to Media Mix Modeling. To fit the model we will use the R package MARSS.</p></p>
</div>

<div class="d-byline">
  Alessandro Ghiretti  
  
<br/>08-12-2020
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#dynamic-linear-model">Dynamic Linear Model</a>
<ul>
<li><a href="#dynamic-regression-with-random-walk-cofficients">Dynamic regression with random walk cofficients</a></li>
<li><a href="#dynamic-regression-with-ar1-coefficients">Dynamic regression with AR(1) coefficients</a></li>
</ul></li>
<li><a href="#dynamic-marketing-mix-model">Dynamic Marketing Mix Model</a>
<ul>
<li><a href="#data-description">Data description</a></li>
<li><a href="#preliminary-analysis">Preliminary Analysis</a></li>
<li><a href="#dynamic-linear-regression">Dynamic linear regression</a>
<ul>
<li><a href="#model-analysis">Model analysis</a></li>
<li><a href="#model-diagnostic">Model diagnostic</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="introduction">Introduction</h1>
<p>Marketers are generally interested in building models that link different marketing variables such as sales activities, operations and external factors, to changes in consumer behavior, such as acquisition, sales, revenue, and retention. Once the model are implemented these can then support the development of forwardlooking business simulations and optimization exercises. When only advertising variables are included in the model this practice is generally called <strong>media mix modeling</strong>.</p>
<p>One of the models most used in practice for media mix modeling is the linear regression model. Once the regression is fitted and unknown parameters are estimated, it is possible to infer the marginal effect that the different explanatory variables have on the response variable. One limitation of the plain linear regression model is that the estimates of the parameters remain constant over time. This assumption might be limited in some context, for example in marketing, where it is well known that the preferences of the customers or the penetration of a certain media evolves with time.</p>
<p>In order to overcome this limitation the Dynamic Linear Regression Model (DLM), which allows for time varying parameters represent a powerful alternative to plain linear regression. Once the DLM is formulated in State Space form it is possible to estimate the parameters in a dynamic way and conduct a series of inferential procedures.</p>
<h1 id="dynamic-linear-model">Dynamic Linear Model</h1>
<p>A Dynamic Linear Regression (DLR) model is a linear regression model where the parameters are allowed to change over time according to a specific stochastic process. A natural representation of the DLM is the state space form, which represent a general representation for many other statistical models. In its most general form a state space model is defined by the following two equations</p>
$$
<span class="math display">\[\begin{aligned}
x_{t} &amp; =B_{t} x_{t-1}+ u_{t}+ C_{t} c_{t}+ G_{t} w_{t}, &amp; \quad w_{t} \sim MVN\left(0, Q_{t}\right) \\
y_{t} &amp; =Z_{t} x_{t}+a_{t}+D_{t} d_{t}+H_{t} v_{t}, &amp; \quad v_{t} \sim MVN\left(0, R_{t}\right) \\

\end{aligned}\]</span>
<p>$$</p>
<p>where <span class="math inline">\(x_{1} \sim MVN(\pi, \Lambda)\)</span> or <span class="math inline">\(x_{0} \sim MVN(\pi, \Lambda)\)</span>. Here <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> can be multivariate series and the index <span class="math inline">\(t\)</span> and denotes that the matrix are allowed to change over time. The different matrices are in generally not know and are related to a series of unknown parameters that need to be estimated. Estimation of the unknown parameters and the related inference are obtained by running the Kalman Filter see <span class="citation" data-cites="durbin2012time"><a href="#ref-durbin2012time" role="doc-biblioref">Durbin and Koopman</a> (<a href="#ref-durbin2012time" role="doc-biblioref">2012</a>)</span> or <span class="citation" data-cites="harvey1989time"><a href="#ref-harvey1989time" role="doc-biblioref">Andrew C. Harvey and Fernandes</a> (<a href="#ref-harvey1989time" role="doc-biblioref">1989</a>)</span> for a detailed description.Given a standard linear regression model</p>
<p><span class="math display">\[
y_{i} = x&#39;_{i} \beta + \epsilon_{i} \quad \epsilon_{i} \sim N(0, \sigma^{2}) 
\]</span></p>
<p>where <span class="math inline">\(y_{i}\)</span> is a scalar variable, <span class="math inline">\(x_{i}\)</span> is a $ k $ vector of regressors, <span class="math inline">\(\beta\)</span> is a <span class="math inline">\(k \times 1\)</span> vector of unknown parameters and <span class="math inline">\(\epsilon_{i}\)</span> is the error term, a dynamic linear model is obtained by allowing the paramters <span class="math inline">\(\beta\)</span> to evolve over time thorough a prescribed model which describes the evolution of <span class="math inline">\(\beta\)</span> over time. That is</p>
<p><span class="math display">\[
\begin{aligned}
y_{i} &amp; = x&#39;_{i} \beta_{t} + \epsilon_{t} \quad  &amp; \epsilon_{t} \sim N(0,\sigma^{2})\\
\beta_{t}&amp; = f(\beta_{t-1}) + v_{t} \quad  &amp; v_{t} \sim N(0,R)
\end{aligned}
\]</span> Several specifications of <span class="math inline">\(f(\cdot)\)</span> can be specified but here we will consider the cases where <span class="math inline">\(f(\cdot)\)</span> is a linear function. Following the state space specification () the dynamic linear regression model can be easily casted in state space form. The unknown parameters becomes the state of the system and the smoothed states obtained with the Kalman Filter represent the estimates of the parameters conditioned on all of the observed data. Depending on the specification of the function <span class="math inline">\(f(\cdot)\)</span> different models can be identified. The two most simplest model are obtained when a random walk process or an autorgressive process are adopted to describe the evolution of <span class="math inline">\(\beta_{t}\)</span></p>
<h2 id="dynamic-regression-with-random-walk-cofficients">Dynamic regression with random walk cofficients</h2>
<p>In this case each <span class="math inline">\(\beta_{t}\)</span> is assumed to be non stationary and it is modeled as a random walk. That is,</p>
<span class="math display">\[\begin{aligned}

y_{t} &amp; = 

\underbrace{\begin{pmatrix}
1 &amp; x_{1} &amp; \cdots &amp; x_{k}
\end{pmatrix}_{t}}_{B_{t}}

\underbrace{
\begin{pmatrix}
\beta_{1} \\
\beta_{2} \\
\vdots \\
\beta_{k+1}
\end{pmatrix}_{t}}_{x_{t}}

+ w_{t}

\\

\underbrace{\begin{pmatrix}
\beta_{1} \\
\beta_{2} \\
\vdots \\
\beta_{k+1}
\end{pmatrix}_{t}}_{x_{t}}


&amp; = 

\underbrace{\begin{pmatrix}
1 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; 1 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; 1 \\
\end{pmatrix}_{t}}_{Z_{t}}

\underbrace{\begin{pmatrix}
\beta_{1} \\
\beta_{2} \\
\vdots \\
\beta_{k+1}
\end{pmatrix}_{t-1}}_{x_{t-1}}

+


\underbrace{\begin{pmatrix}
v_{1} \\
v_{2} \\
\vdots \\
v_{k+1}
\end{pmatrix}_{t}}_{v_{t}}


\end{aligned}\]</span>
<h2 id="dynamic-regression-with-ar1-coefficients">Dynamic regression with AR(1) coefficients</h2>
<p>When a stationarity assumption is necessary on the parameters <span class="math inline">\(\beta_{t}\)</span> the autoregressive process of order one represent the simplest form of dynamic linear model.</p>
<span class="math display">\[\begin{aligned}

y_{t} &amp; = 

\underbrace{\begin{pmatrix}
1 &amp; x_{1} &amp; \cdots &amp; x_{k}
\end{pmatrix}_{t}}_{B_{t}}

\underbrace{
\begin{pmatrix}
\beta_{1} \\
\beta_{2} \\
\vdots \\
\beta_{k+1}
\end{pmatrix}_{t}}_{x_{t}}

+ w_{t}

\\

\underbrace{\begin{pmatrix}
\beta_{1} \\
\beta_{2} \\
\vdots \\
\beta_{k+1}
\end{pmatrix}_{t}}_{x_{t}}


&amp; = 

\underbrace{\begin{pmatrix}
\phi_{11} &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; \phi_{21} &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; \phi_{k1} \\
\end{pmatrix}_{t}}_{Z_{t}}

\underbrace{\begin{pmatrix}
\beta_{1} \\
\beta_{2} \\
\vdots \\
\beta_{k+1}
\end{pmatrix}_{t-1}}_{x_{t-1}}

+


\underbrace{\begin{pmatrix}
v_{1} \\
v_{2} \\
\vdots \\
v_{k+1}
\end{pmatrix}_{t}}_{v_{t}}

\end{aligned}\]</span>
<h1 id="dynamic-marketing-mix-model">Dynamic Marketing Mix Model</h1>
<h2 id="data-description">Data description</h2>
<p>The data contains sales (expressed in thousand of units) and the corresponding advertising budget (expressed in thousand of dollars) for several media. The data ranges from 2001/01/01 to 2017/08/01 for a total of 200 observations.</p>
<h2 id="preliminary-analysis">Preliminary Analysis</h2>
<p>We begin by loading the packages used for the analysis</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyr.tidyverse.org'>tidyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://nwfsc-timeseries.github.io/MARSS/'>MARSS</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/taiyun/corrplot'>corrplot</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/hadley/reshape'>reshape2</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>After loading the data that in my case was on a desktop folder we begin the analysis looking at the different time series.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code>  <span class='va'>advertising</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Native"</span>,<span class='st'>"Programmatic"</span>,<span class='st'>"OOH"</span>,<span class='st'>"sales"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Time"</span><span class='op'>)</span>, names_to <span class='op'>=</span> <span class='st'>"Media"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Time</span>, y <span class='op'>=</span> <span class='va'>value</span>, color <span class='op'>=</span> <span class='va'>Media</span>, <span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows  <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>Media</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_date.html'>scale_x_date</a></span><span class='op'>(</span>date_breaks <span class='op'>=</span> <span class='st'>"1 year"</span>,date_labels <span class='op'>=</span> <span class='st'>"%Y"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>strip.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
  strip.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>, 
  axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>250</span>, by <span class='op'>=</span> <span class='fl'>125</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="18-12-2020-DynamicRegression_files/figure-html5/unnamed-chunk-3-1.png" width="624" /></p>
</div>
<p>A time series plot reveals that there is a great difference between the budget allocated to the different media. TV represents the media to which more money are allocated and the investments are divided depending on the TV program. Moreover, it emerges clearly that when some media are used other are stopped. In particular overt the period 2009-2011 no budget was allocated to Search and social media but a high investment was allocated to tv_cricket.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="18-12-2020-DynamicRegression_files/figure-html5/unnamed-chunk-4-1.png" width="624" /></p>
</div>
<p>From the correlation matrix it appears that sales are positively correlated with the budget allocated to TV, Radio, Social, Display rest and Search while there is no apparent linear relationship with the other media. TV and Radio represent the classical media more correlated with sales, while Social, Display_Rest and Search are the modern media with the highest correlation. As it is evident from the correlation matrix there is a strong positive correlation between the budget allocated to different media. For example there is an high positive correlation between Social, tv_sponsorship, Display_Rest and Search, meaning that when the budget in increased in one of these media is increased also in the others.</p>
<h2 id="dynamic-linear-regression">Dynamic linear regression</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># convert the data into a matrix</span>
<span class='va'>response</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='va'>advertising</span><span class='op'>$</span><span class='va'>sales</span>, nrow <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='co'># covariates matrix (k x TT)</span>
<span class='va'>covariates</span> <span class='op'>&lt;-</span> <span class='va'>advertising</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Time"</span>,<span class='st'>"sales"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>covariates</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>covariates</span><span class='op'>)</span> 

<span class='co'># number of state = # of regression params (slope(s) + intercept)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fl'>1</span> <span class='op'>+</span> <span class='fl'>12</span>

<span class='co'># obtain the total number or observations</span>
<span class='va'>TT</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>response</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Next, we proceed to specify the matrices needed for fitting the dlm model</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># STATE EQUATION</span>
<span class='co'># specify the B matrix </span>
<span class='va'>B</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>)</span>
<span class='co'># specify B matrix for AR1 states</span>
<span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span><span class='op'>(</span><span class='va'>B</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>13</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"b"</span>,<span class='fl'>2</span><span class='op'>:</span><span class='fl'>13</span>, sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>
<span class='co'># specify remaining matrices</span>
<span class='va'>U</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>, nrow <span class='op'>=</span> <span class='va'>m</span>, ncol <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> 
<span class='va'>Q</span> <span class='op'>&lt;-</span> <span class='st'>"unconstrained"</span>

<span class='co'># OBSERVATION EQUATION</span>
<span class='va'>Z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>m</span>, <span class='va'>TT</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># NxMxT; empty for now</span>
<span class='va'>Z</span><span class='op'>[</span><span class='fl'>1</span>, <span class='fl'>1</span>, <span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>TT</span><span class='op'>)</span> <span class='co'># Nx1; 1's for intercept</span>
<span class='va'>Z</span><span class='op'>[</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>:</span><span class='fl'>13</span>, <span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>covariates</span> <span class='co'># Nx1; regr variable</span>
<span class='va'>A</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span> <span class='co'># 1x1; scalar = 0</span>
<span class='va'>R</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='st'>"r"</span><span class='op'>)</span> <span class='co'># 1x1; scalar = r</span>

<span class='co'># initialize thate vector</span>
<span class='va'>inits.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x0 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>0</span>, nrow <span class='op'>=</span> <span class='va'>m</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># set parameters for optimizer</span>
<span class='va'>cntl.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>minit <span class='op'>=</span> <span class='fl'>200</span>, maxit <span class='op'>=</span> <span class='fl'>20000</span><span class='op'>)</span>

<span class='co'># list of model matrices &amp; vectors</span>
<span class='va'>mod.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>B <span class='op'>=</span> <span class='va'>B</span>, U <span class='op'>=</span> <span class='va'>U</span>, Q <span class='op'>=</span> <span class='va'>Q</span>, Z <span class='op'>=</span> <span class='va'>Z</span>, A <span class='op'>=</span> <span class='va'>A</span>, R <span class='op'>=</span> <span class='va'>R</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>And finally we fit the model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># dlm with autoregressive states</span>
<span class='va'>dlr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MARSS/man/MARSS.html'>MARSS</a></span><span class='op'>(</span><span class='va'>response</span>, inits <span class='op'>=</span> <span class='va'>inits.list</span>, model <span class='op'>=</span> <span class='va'>mod.list</span>,
                 control <span class='op'>=</span> <span class='va'>cntl.list</span>, silent <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Error in chol.default(denom) : 
  il minore principale di ordine 7 non  definito positivo</code></pre>
</div>
<h3 id="model-analysis">Model analysis</h3>
<p>We start by examining the smoothed states in Figure <a href="#fig:smoothstate">1</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span id="fig:smoothstate"></span>
<img src="18-12-2020-DynamicRegression_files/figure-html5/smoothstate-1.png" alt="Smoothed states" width="624" />
<p class="caption">
Figure 1: Smoothed states
</p>
</div>
</div>
<p>Looking at the smoothed states it appears that there is an high variation in the states. The intercept, which represent the average volume of sales in absence of advertising activities in sales shows an increasing trend. Display_Rest, Native, OOH, Programmatic Radio and Magazines shows an increasing marginal effect on the quantity of units sold. Programmatic being the one with the highest marginal effect. The interpretation of the estimated negative values associated to the budget allocated to a particular media has many interpretations. It might indicate that for that period the particular activity performed on that media was not appreciated by the customer, or again it might indicate that the customer got bored or not interested in that media and using it as advertisement produced the opposite effect on sales.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="18-12-2020-DynamicRegression_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<p>The correlation structure of the states is of complex interpretation. However the important thing is that it highlights the fact that there exhists synergies between some medias. For example when the marginal effect of the budget allocated to tv_sponsorship increases we expect that also the marginal effect allocated to budget will increase. Apart from the theoretical assumptions on the regression parameters one of the main advantages in adopting a state space representation is the possibility of producing forecasts as soon as new data is available. By running the Kalman filter, it is in fact possible to produce the one step ahead forecasts, <span class="math inline">\(\hat{y}_{t+1|t}\)</span>, in an iterative fashion. The one step ahead predictions obtained with the fitted dynamic linear regression are reported in Figure <a href="#fig:yhat"><strong>??</strong></a>.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="model-diagnostic">Model diagnostic</h3>
<p>We conclude the analysis by inspecting the residuals plot, in order to identify violation to the underlying model assumptions</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>MARSSresiduals.tT reported warnings. See msg element or attribute of returned residuals object.</code></pre>
<pre><code>MARSSresiduals.tT reported warnings. See msg element or attribute of returned residuals object.</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span id="fig:fittedres"></span>
<img src="18-12-2020-DynamicRegression_files/figure-html5/fittedres-1.png" alt="Fitted residuals" width="624" />
<p class="caption">
Figure 2: Fitted residuals
</p>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span id="fig:stateres"></span>
<img src="18-12-2020-DynamicRegression_files/figure-html5/stateres-1.png" alt="State residuals" width="624" />
<p class="caption">
Figure 3: State residuals
</p>
</div>
</div>
<p>Both the model and the state residuals appear to be well dispersed with no particular patterns that may indicate autocorrelation or cyclical behavior. Both in the model and in the state residuals plot some outliers can be identified.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="18-12-2020-DynamicRegression_files/figure-html5/unnamed-chunk-10-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="18-12-2020-DynamicRegression_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
</div>
<p>Finally, the inspection of the qqplots reveal that there is no clear departure from normality in the state while the model residuals appear to have heavier tails than a normal distribution.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-chan2017challenges" class="csl-entry" role="doc-biblioentry">
Chan, David, and Mike Perry. 2017. <span>Challenges and Opportunities in Media Mix Modeling.</span>
</div>
<div id="ref-durbin2012time" class="csl-entry" role="doc-biblioentry">
Durbin, James, and Siem Jan Koopman. 2012. <em>Time Series Analysis by State Space Methods</em>. Oxford university press.
</div>
<div id="ref-dlmharvey" class="csl-entry" role="doc-biblioentry">
Harvey, A. C., and G. D. A. Phillips. 1982. <span>The Estimation of Regression Models with Time-Varying Parameters.</span> In <em>Games, Economic Dynamics, and Time Series Analysis</em>, edited by M. Deistler, E. Frst, and G. Schwdiauer, 30621. Heidelberg: Physica-Verlag HD.
</div>
<div id="ref-harvey1989time" class="csl-entry" role="doc-biblioentry">
Harvey, Andrew C, and Clara Fernandes. 1989. <span>Time Series Models for Count or Qualitative Observations.</span> <em>Journal of Business &amp; Economic Statistics</em> 7 (4): 40717.
</div>
<div id="ref-MARSS" class="csl-entry" role="doc-biblioentry">
Holmes, Elizabeth, Eric Ward, Mark Scheuerell, and Kellie Wills. 2020. <em>MARSS: Multivariate Autoregressive State-Space Modeling</em>. <a href="https://CRAN.R-project.org/package=MARSS">https://CRAN.R-project.org/package=MARSS</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
